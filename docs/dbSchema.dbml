// Documentation URL - https://www.dbml.org/docs/
// Editor: https://dbdiagram.io/d

Table images {
  id bigint
  shortened_url varchar
  status tinyint [
    note: '
    1 = ACTIVE,
    2 = DELETED
    ']
  ipfs_object_id bigint [ref: > ipfs_objects.id]
  created_at timestamp
  updated_at timestamp

  indexes {
      (id) [pk]
  }
}

Table texts {
  id bigint
  text varchar
  created_at timestamp
  updated_at timestamp

  indexes {
      (id) [pk]
  }
}

Table lens_posts {
  id bigint
  owner_user_id bigint [ref: > users.id]
  lens_publication_id varchar
  title varchar
  description_text_id bigint [ref: - texts.id]
  image_id bigint [ref: - images.id]
  total_votes integer
  ipfs_object_id bigint [ref: > ipfs_objects.id]
  nft_data varchar
  created_at timestamp
  updated_at timestamp

  indexes {
      (id) [pk]
      (lens_publication_id) [unique]
  }
}

Table votes {
  id bigint
  lens_post_id bigint [ref: > lens_posts.id]
  user_id bigint [ref: > users.id]
  status tinyint [
    note: '
    1 = VOTED,
    2 = IGNORED
    ']
  collect_nft_transaction_hash varchar
  created_at timestamp
  updated_at timestamp

  indexes {
      (id) [pk]
      (lens_post_id, user_id) [unique]
      (user_id, status)
  }
}

Table users {
  id bigint
  lens_profile_id varchar
  lens_profile_owner_address varchar
  status tinyint [
    note: '
    1 = ACTIVE,
    2 = DELETED
    ']
  cookie_token varchar
  created_at timestamp
  updated_at timestamp

  indexes {
      (id) [pk]
      (lens_profile_id) [unique]
  }
}

Table ipfs_objects {
  id bigint
  kind tinyint [
    note: '
    1 = CHAIN,
    2 = WHISPER,
    3 = IMAGE
    ']
  cid varchar
  cts timestamp
  uts timestamp
  indexes {
      (id) [pk]
  }
}

